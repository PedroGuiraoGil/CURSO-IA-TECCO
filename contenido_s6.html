<style>
    /* 1. Estilos Generales y Correcci√≥n de Color */
    .inner-wrapper-s6 {
        font-family: 'Segoe UI', Helvetica, Arial, sans-serif;
        background-color: #0f172a; /* Fondo oscuro global */
        color: #f1f5f9; /* Texto claro */
        padding: 20px;
        border-radius: 8px;
        line-height: 1.6;
    }
    
    /* Forzar t√≠tulos a blanco/color */
    .inner-wrapper-s6 h2, .inner-wrapper-s6 h3, .inner-wrapper-s6 h4 {
        color: #ffffff !important;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }

    /* 2. Men√∫ Superior (Pesta√±as Principales) */
    .inner-nav-tabs {
        display: flex;
        flex-wrap: wrap;
        gap: 5px;
        margin-bottom: 20px;
        border-bottom: 2px solid #334155;
        padding-bottom: 10px;
    }
    .inner-nav-tab {
        background-color: #1e293b;
        color: #94a3b8;
        border: 1px solid #334155;
        padding: 10px 15px;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.2s ease;
    }
    .inner-nav-tab:hover {
        background-color: #334155;
        color: #fff;
    }
    .inner-nav-tab.active {
        background-color: #6366f1; /* Indigo */
        color: white !important;
        border-color: #818cf8;
        box-shadow: 0 0 10px rgba(99, 102, 241, 0.3);
    }

    /* Ocultar contenido por defecto */
    .inner-tab-content {
        display: none; /* Se oculta todo al inicio */
        animation: fadeIn 0.4s;
    }
    .inner-tab-content.active {
        display: block; /* Solo se muestra el activo */
    }

    /* 3. Estilos Espec√≠ficos Secci√≥n Arquitectura */
    .arch-title {
        text-align: center;
        background: linear-gradient(90deg, #818cf8, #f472b6);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-size: 2em;
        font-weight: 800;
    }
    
    /* Grid de tarjetas */
    .arch-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    /* Tarjetas Interactivas (Boxes que se iluminan) */
    .arch-card {
        background-color: #1e293b !important;
        border: 1px solid #334155;
        border-radius: 12px;
        padding: 20px;
        transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
        box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    }
    .arch-card:hover {
        transform: translateY(-5px); /* Efecto elevaci√≥n */
        border-color: #818cf8; /* Borde brilla */
        box-shadow: 0 10px 15px rgba(129, 140, 248, 0.2); /* Sombra brilla */
    }
    
    /* Listas dentro de arquitectura */
    .arch-list { padding-left: 20px; margin: 0; }
    .arch-list li { color: #cbd5e1 !important; margin-bottom: 8px; }

    /* Botones de Apps (Word, Excel...) */
    .arch-tabs-nav {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-bottom: 20px;
    }
    .arch-app-btn {
        flex: 1;
        min-width: 100px;
        padding: 12px;
        background-color: #334155;
        color: #e2e8f0;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        text-align: center;
        transition: 0.2s;
    }
    .arch-app-btn:hover { background-color: #475569; color: white; }
    
    /* Estados Activos de Apps */
    .arch-app-btn.active { color: white !important; transform: scale(1.05); }
    .btn-word.active { background-color: #4f46e5 !important; box-shadow: 0 0 15px rgba(79, 70, 229, 0.5); }
    .btn-excel.active { background-color: #16a34a !important; box-shadow: 0 0 15px rgba(22, 163, 74, 0.5); }
    .btn-ppt.active { background-color: #dc2626 !important; box-shadow: 0 0 15px rgba(220, 38, 38, 0.5); }
    .btn-outlook.active { background-color: #0891b2 !important; box-shadow: 0 0 15px rgba(8, 145, 178, 0.5); }
    .btn-teams.active { background-color: #7c3aed !important; box-shadow: 0 0 15px rgba(124, 58, 237, 0.5); }

    /* Paneles de contenido de Apps */
    .arch-app-content {
        display: none;
        background: #1e293b;
        padding: 20px;
        border-radius: 12px;
        border-top: 5px solid #6366f1;
    }
    .arch-app-content.active { display: block; animation: fadeIn 0.4s; }

    /* Acorde√≥n / Desplegable */
    .arch-accordion-btn {
        width: 100%;
        background: #0f172a;
        border: 1px solid #475569;
        color: #93c5fd !important;
        padding: 15px;
        text-align: left;
        cursor: pointer;
        border-radius: 8px;
        margin-top: 15px;
        display: flex;
        justify-content: space-between;
        font-weight: bold;
        transition: background 0.2s;
    }
    .arch-accordion-btn:hover { background: #1e293b; }
    
    .arch-accordion-content {
        display: none; /* Oculto por defecto */
        padding: 15px;
        background: #020617;
        border-radius: 0 0 8px 8px;
        border: 1px solid #475569;
        border-top: none;
        color: #a5f3fc;
        font-family: monospace;
    }

    /* Animaciones y Utilidades */
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    .tool-card, .error-item, .exercise-box {
        background: #1e293b; border: 1px solid #334155; padding: 15px; border-radius: 8px; margin-bottom: 15px;
    }
    .highlight-box { background: rgba(14, 165, 233, 0.1); border-left: 4px solid #0ea5e9; padding: 15px; margin-bottom: 20px; border-radius: 4px; }
    .tool-link { color: #38bdf8; text-decoration: none; font-weight: bold; }
    .tool-link:hover { text-decoration: underline; }
</style>

<script>
    // 1. FUNCI√ìN PARA EL MEN√ö PRINCIPAL (Introducci√≥n, Conceptos...)
    function showInnerTab(tabId, groupName) {
        // Ocultar todas las pesta√±as principales
        var contents = document.getElementsByClassName('inner-tab-content');
        for (var i = 0; i < contents.length; i++) {
            contents[i].style.display = 'none'; // Forzar ocultado
            contents[i].classList.remove('active');
        }
        
        // Desactivar botones principales
        var tabs = document.getElementsByClassName('inner-nav-tab');
        for (var i = 0; i < tabs.length; i++) {
            tabs[i].classList.remove('active');
        }

        // Mostrar la seleccionada
        var selected = document.getElementById(tabId);
        if (selected) {
            selected.style.display = 'block'; // Forzar mostrado
            setTimeout(function() { selected.classList.add('active'); }, 10);
        }
        
        // Activar el bot√≥n pulsado (buscando por texto o evento si fuera necesario, 
        // pero aqu√≠ usamos event.currentTarget en el HTML)
        if (event && event.currentTarget) {
            event.currentTarget.classList.add('active');
        }
    }

    // 2. FUNCI√ìN PARA LAS PESTA√ëAS DE ARQUITECTURA (Word, Excel...)
    function showArchApp(appId) {
        // Ocultar paneles de apps
        var panels = document.getElementsByClassName('arch-app-content');
        for (var i = 0; i < panels.length; i++) {
            panels[i].style.display = 'none';
            panels[i].classList.remove('active');
        }

        // Desactivar botones de apps
        var btns = document.getElementsByClassName('arch-app-btn');
        for (var i = 0; i < btns.length; i++) {
            btns[i].classList.remove('active');
        }

        // Mostrar panel actual
        var current = document.getElementById(appId);
        if (current) {
            current.style.display = 'block';
            setTimeout(function() { current.classList.add('active'); }, 10);
            
            // Colorear borde superior din√°micamente
            var color = "#6366f1"; // Default
            if(appId.includes('excel')) color = "#16a34a";
            if(appId.includes('ppt')) color = "#dc2626";
            if(appId.includes('outlook')) color = "#0891b2";
            if(appId.includes('teams')) color = "#7c3aed";
            current.style.borderTopColor = color;
        }

        // Activar bot√≥n pulsado
        if (event && event.currentTarget) {
            event.currentTarget.classList.add('active');
        }
    }

    // 3. FUNCI√ìN PARA DESPLEGABLES (ACORDE√ìN)
    function toggleAccordion(btn) {
        var content = btn.nextElementSibling;
        var icon = btn.querySelector('.icon');
        
        // Comprobar si est√° visible calculando el estilo computado o el display directo
        if (content.style.display === 'block') {
            content.style.display = 'none';
            icon.innerHTML = '+';
        } else {
            content.style.display = 'block';
            icon.innerHTML = '‚àí';
        }
    }

    // 4. FUNCI√ìN PARA EL MINITEST
    function resetMinitest(id) {
        var feedbacks = document.getElementsByClassName('feedback');
        for(var i=0; i<feedbacks.length; i++) feedbacks[i].innerHTML = '';
        var options = document.getElementsByClassName('minitest-option');
        for(var i=0; i<options.length; i++) {
            options[i].style.backgroundColor = '';
            options[i].style.color = '';
        }
    }

    // Inicializaci√≥n de clicks para el minitest (delegaci√≥n simple)
    document.addEventListener('click', function(e) {
        if(e.target && e.target.classList.contains('minitest-option')) {
            var isCorrect = e.target.getAttribute('data-correct') === 'true';
            var feedbackId = e.target.getAttribute('data-question').replace('s6-', 's6-feedback-'); // Ajuste simple
            // Como los IDs de feedback son s6-feedback-1, etc.
            // Asumimos estructura simple: next sibling o b√∫squeda por ID
            var parent = e.target.parentElement;
            var feedback = parent.querySelector('.feedback');
            
            if(isCorrect) {
                e.target.style.backgroundColor = '#16a34a';
                e.target.style.color = 'white';
                if(feedback) feedback.innerHTML = '‚úÖ ¬°Correcto!';
            } else {
                e.target.style.backgroundColor = '#dc2626';
                e.target.style.color = 'white';
                if(feedback) feedback.innerHTML = '‚ùå Incorrecto, prueba otra vez.';
            }
        }
    });
</script>

<div class="inner-wrapper-s6">

    <div class="inner-nav-tabs">
        <button class="inner-nav-tab active" onclick="showInnerTab('s6-intro', 's6')">üìö Introducci√≥n</button>
        <button class="inner-nav-tab" onclick="showInnerTab('s6-conceptos', 's6')">üîß Conceptos Clave</button>
        <button class="inner-nav-tab" onclick="showInnerTab('s6-arquitectura', 's6')">üß† Arquitectura Copilot</button>
        <button class="inner-nav-tab" onclick="showInnerTab('s6-lado-oscuro', 's6')">‚ö†Ô∏è Riesgos</button>
        <button class="inner-nav-tab" onclick="showInnerTab('s6-actividades', 's6')">üìã Actividades</button>
        <button class="inner-nav-tab" onclick="showInnerTab('s6-minitest', 's6')">‚úÖ MiniTest</button>
        <button class="inner-nav-tab" onclick="showInnerTab('s6-errores', 's6')">‚ö†Ô∏è Errores</button>
        <button class="inner-nav-tab" onclick="showInnerTab('s6-ia-habla', 's6')">üîÆ La IA Habla</button>
    </div>

    <div id="s6-intro" class="inner-tab-content active" style="display:block;"> <h2>Sesi√≥n 6: Agentes y Copilot</h2>
        <div class="highlight-box">
            <h4 style="color: #0ea5e9 !important; margin:0;">üöÄ Enlace a Presentaci√≥n</h4>
            <p><a href="https://app.presentations.ai/view/ehdF8zTl5Z" target="_blank" class="tool-link">Ver Presentaci√≥n Visual de la Sesi√≥n 6</a></p>
        </div>
        <p>Bienvenido al final del camino. Aqu√≠ conectamos tus habilidades con la realidad empresarial.</p>
        <ol style="margin-left: 20px;">
            <li><strong>El Futuro:</strong> Agentes que act√∫an, no solo chatean.</li>
            <li><strong>La Arquitectura:</strong> Profundizaci√≥n t√©cnica (Nueva Pesta√±a).</li>
            <li><strong>La Seguridad:</strong> Por qu√© Copilot es vital para la empresa.</li>
        </ol>
    </div>

    <div id="s6-conceptos" class="inner-tab-content">
        <h2>üîß Conceptos Clave</h2>
        <div class="tool-card">
            <h3>Nivel 1: GPTs Personalizados</h3>
            <p>Son mini-IAs configuradas con tus propios manuales PDF. Ideales para consultas espec√≠ficas.</p>
        </div>
        <div class="tool-card">
            <h3>Nivel 2: Agentes de IA</h3>
            <p>La evoluci√≥n del Chatbot. Un Agente puede realizar secuencias de pasos: buscar > comparar > reservar.</p>
        </div>
        <div class="tool-card">
            <h3>Nivel 3: Microsoft Copilot</h3>
            <p>Tu IA segura empresarial. No entrena con tus datos y respeta tus permisos de acceso.</p>
        </div>
    </div>

    <div id="s6-arquitectura" class="inner-tab-content">
        <h2 class="arch-title">Arquitectura Copilot</h2>
        <p style="text-align:center; margin-bottom: 30px; color:#cbd5e1;">Diferencia visual entre Chat Central e In-App</p>
        
        <div class="arch-grid">
            <div class="arch-card">
                <h3 style="color:#818cf8 !important;">1. Chat Central (Business Chat)</h3>
                <p><strong>√Åmbito:</strong> Toda la organizaci√≥n.</p>
                <p>Busca en tus correos, chats y archivos de OneDrive simult√°neamente.</p>
                <p><em>Ej: "¬øQu√© pas√≥ con el cliente X la semana pasada?"</em></p>
            </div>
            <div class="arch-card">
                <h3 style="color:#f472b6 !important;">2. Copilot In-App</h3>
                <p><strong>√Åmbito:</strong> Documento activo.</p>
                <p>Vive en el panel lateral de Word/Excel. Solo "ve" lo que tienes abierto.</p>
                <p><em>Ej: "Reescribe este p√°rrafo."</em></p>
            </div>
        </div>

        <h3>Capacidades por Aplicaci√≥n (Haz clic)</h3>
        <div class="arch-tabs-nav">
            <button class="arch-app-btn btn-word active" onclick="showArchApp('app-word')">Word</button>
            <button class="arch-app-btn btn-excel" onclick="showArchApp('app-excel')">Excel</button>
            <button class="arch-app-btn btn-ppt" onclick="showArchApp('app-ppt')">PowerPoint</button>
            <button class="arch-app-btn btn-outlook" onclick="showArchApp('app-outlook')">Outlook</button>
            <button class="arch-app-btn btn-teams" onclick="showArchApp('app-teams')">Teams</button>
        </div>

        <div id="app-word" class="arch-app-content active" style="display:block;">
            <h3 style="color:#818cf8 !important;">Microsoft Word</h3>
            <ul class="arch-list">
                <li>Generaci√≥n de borradores completos.</li>
                <li>Edici√≥n de tono y estilo.</li>
            </ul>
            <button class="arch-accordion-btn" onclick="toggleAccordion(this)">
                üëÅÔ∏è Ver Ejemplo Prompt <span class="icon">+</span>
            </button>
            <div class="arch-accordion-content">
                "Escribe un borrador de propuesta comercial basado en el archivo 'Notas_Reunion.docx' con tono persuasivo."
            </div>
        </div>

        <div id="app-excel" class="arch-app-content">
            <h3 style="color:#16a34a !important;">Microsoft Excel</h3>
            <ul class="arch-list">
                <li>An√°lisis de tendencias y patrones.</li>
                <li>Creaci√≥n de columnas con f√≥rmulas complejas.</li>
            </ul>
            <button class="arch-accordion-btn" onclick="toggleAccordion(this)">
                üëÅÔ∏è Ver Ejemplo Prompt <span class="icon">+</span>
            </button>
            <div class="arch-accordion-content">
                "Analiza la tabla y resalta en amarillo los productos con margen inferior al 15%."
            </div>
        </div>

        <div id="app-ppt" class="arch-app-content">
            <h3 style="color:#dc2626 !important;">PowerPoint</h3>
            <p>Convierte documentos de Word en presentaciones autom√°ticamente.</p>
            <button class="arch-accordion-btn" onclick="toggleAccordion(this)">
                üëÅÔ∏è Ver Ejemplo Prompt <span class="icon">+</span>
            </button>
            <div class="arch-accordion-content">
                "Crea una presentaci√≥n de 10 diapositivas a partir del archivo 'Informe_Anual.docx'."
            </div>
        </div>

        <div id="app-outlook" class="arch-app-content">
            <h3 style="color:#0891b2 !important;">Outlook</h3>
            <p>Resume hilos infinitos de correos y sugiere respuestas r√°pidas.</p>
        </div>

        <div id="app-teams" class="arch-app-content">
            <h3 style="color:#7c3aed !important;">Teams</h3>
            <p>Genera actas de reuniones (qui√©n dijo qu√©, tareas pendientes) en tiempo real.</p>
        </div>
    </div>

    <div id="s6-lado-oscuro" class="inner-tab-content">
        <h2>‚ö†Ô∏è Riesgos y Seguridad</h2>
        <div class="error-item">
            <h3>No alimentes a la IA p√∫blica</h3>
            <p>Si subes un contrato confidencial a ChatGPT gratuito, esa informaci√≥n podr√≠a usarse para entrenar al modelo. <strong>Soluci√≥n:</strong> Usa siempre Copilot con licencia empresarial para datos sensibles.</p>
        </div>
        <div class="error-item">
            <h3>Alucinaciones de Agentes</h3>
            <p>Si un agente navega por ti, verifica siempre la URL final y el resumen de compra antes de pagar.</p>
        </div>
    </div>

    <div id="s6-actividades" class="inner-tab-content">
        <h2>üìã Actividades</h2>
        <div class="exercise-box">
            <h3>1. Dise√±a tu Workflow</h3>
            <p>Piensa en una tarea repetitiva (ej. revisar facturas). Escribe paso a paso qu√© le pedir√≠as a un Agente que hiciera por ti.</p>
        </div>
        <div class="exercise-box">
            <h3>2. Pr√°ctica en Outlook (Copilot)</h3>
            <p>Busca un hilo de correos largo y usa el bot√≥n "Resumir por Copilot". Compara el resumen con la realidad.</p>
        </div>
    </div>

    <div id="s6-minitest" class="inner-tab-content">
        <h2>‚úÖ MiniTest Final</h2>
        <div class="minitest">
            <div class="minitest-question" style="margin-bottom:20px;">
                <h4>1. ¬øQu√© diferencia a un Agente de un Chatbot?</h4>
                <div class="minitest-option" data-question="s6-1" data-correct="false" style="padding:10px; background:#334155; margin:5px; border-radius:4px; cursor:pointer;">a) Nada, son lo mismo.</div>
                <div class="minitest-option" data-question="s6-1" data-correct="true" style="padding:10px; background:#334155; margin:5px; border-radius:4px; cursor:pointer;">b) El Chatbot habla, el Agente act√∫a (ej. reserva vuelos).</div>
                <div class="feedback" style="margin-top:5px; font-weight:bold;"></div>
            </div>
            
            <div class="minitest-question" style="margin-bottom:20px;">
                <h4>2. ¬øD√≥nde vive Copilot In-App?</h4>
                <div class="minitest-option" data-question="s6-2" data-correct="true" style="padding:10px; background:#334155; margin:5px; border-radius:4px; cursor:pointer;">a) En el panel lateral del documento activo.</div>
                <div class="minitest-option" data-question="s6-2" data-correct="false" style="padding:10px; background:#334155; margin:5px; border-radius:4px; cursor:pointer;">b) Solo en la web.</div>
                <div class="feedback" style="margin-top:5px; font-weight:bold;"></div>
            </div>
            <button class="reset-btn" onclick="resetMinitest('s6')" style="padding:10px 20px; background:#6366f1; color:white; border:none; border-radius:6px; cursor:pointer;">üîÑ Reiniciar Test</button>
        </div>
    </div>
    
    <div id="s6-errores" class="inner-tab-content">
        <h2>‚ö†Ô∏è Errores Comunes</h2>
        <p>1. Confiar ciegamente en la salida de la IA sin revisar.</p>
        <p>2. Usar la herramienta incorrecta (ChatGPT para datos internos, Copilot para poemas creativos).</p>
    </div>

    <div id="s6-ia-habla" class="inner-tab-content">
        <div class="ia-speaks-container" style="text-align:center; padding:40px;">
            <h2>üîÆ La IA Habla</h2>
            <p style="font-size:1.2em; font-style:italic; color:#a5b4fc;">"Ya no soy una herramienta. Soy tu copiloto."</p>
            <p>Gracias por acompa√±arme en este viaje de 6 sesiones.</p>
        </div>
    </div>

</div>
